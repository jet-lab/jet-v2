name: build

env:
  SOLANA_VERSION: 1.10.29
  ANCHOR_CLI_VERSION: 0.24.2
  HOME: /root

on:
  push:
    branches: 
      - "master"
  pull_request: 

jobs:
  # ts_test:
  #   name: Typescript Integration Tests
  #   runs-on: ubuntu-latest
  #   container:
  #     image: jetprotocol/builder:root-solana1.10.35-anchor0.25.0-1
  #     env:
  #       HOME: /root
  #   steps:

  #     - name: Checkout
  #       uses: actions/checkout@v3

  #     # - id: CacheTSDeps
  #     #   uses: actions/cache@v2
  #     #   with:
  #     #     key: cache-${{ runner.os }}-a${{ env.ANCHOR_CLI_VERSION }}-s${{ env.SOLANA_VERSION }}
  #     #     path: |
  #     #       ~/.cache/act
  #     #       ~/.cache/solana
  #     #       ~/.cargo/bin/
  #     #       ~/.cargo/registry/index/
  #     #       ~/.cargo/registry/cache/
  #     #       ~/.cargo/git/db/
  #     #       ~/.local/share/solana/
  #     #       ~/.npm


  #     - name: npm clean install
  #       run: npm ci

  #     - name: debugging2
  #       run: avm list
  #     - name: debugging2
  #       run: |
  #         anchor
  #         anchor test --skip-lint -- --features testing
  #     - name: TS Test
  #       run: npm run test
  # downstream_test:
  #   name: Test Dependent Modules
  #   runs-on: ubuntu-latest
  #   needs: [ts_test]
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3

  #     - id: CacheTSDeps
  #       uses: actions/cache@v2
  #       with:
  #         key: cache-${{ runner.os }}-a${{ env.ANCHOR_CLI_VERSION }}-s${{ env.SOLANA_VERSION }}
  #         path: |
  #           ~/.cache/act
  #           ~/.cache/solana
  #           ~/.cargo/bin/
  #           ~/.cargo/registry/index/
  #           ~/.cargo/registry/cache/
  #           ~/.cargo/git/db/
  #           ~/.local/share/solana/
  #           ~/.npm

  #     - name: Submodule Tests
  #       run: npm run mod